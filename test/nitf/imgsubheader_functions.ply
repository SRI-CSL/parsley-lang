// A series of functions defined in response to NITF image subheader requirements
// 
// SRI International, 2023


fun is_valid_isclsy_1(isclas: [byte], isclsy: [byte]) -> bool = {
    (case isclas of
        | "U" -> bool::True()
        | _ -> (case isclsy of
                    | "  " -> bool::False()
                    | _ -> bool::True()
                )
    )
}


fun udofl_setup(udidl: [byte]) -> usize = {
    // UDOFL: user defined overflow field
    // shall be omitted if the field UDIDL
    // contains BCS zeros (0x30)
    (case udidl of 
        | "     " -> 0u
        | _ -> 3u
    )
}


fun ixsofl_setup(ixshdl: [byte]) -> usize = {
    // IXSOFL: image extended subheader overflow
    // field shall be omitted if the field IXSHDL 
    // contains BCS zeros (0x30)
    (case ixshdl of 
        | "     " -> 0u
        | _ -> 3u
    )
}


fun xbands_setup(nbands: [byte]) -> usize = {
    // XBANDS: number of multispectral bands.
    // The field shall contain the number of bands
    // or data points comprising the multiple band image 
    // IF nbands is BCS zero ELSE it shall be omitted.
    (case nbands of
        | " " -> 5u
        | _ -> 0u
    )
}


fun comrat_setup(ic: [byte]) -> usize = {
    // COMRAT: Compression Rate Code.
    // If the IC field contains C1, C3, C4, C5, C7, C8, C9, 
    // CA, CB, I1, M1, M3, M4, M5, M7, M8, M9, MA, or MB,
    // this field shall be present and contain a code indicating the compression
    // rate for the image.
    (case ic of
        | "NC" -> 0u
        | "NM" -> 0u
        | "M6" -> 0u
        | _ -> 4u
    )
}